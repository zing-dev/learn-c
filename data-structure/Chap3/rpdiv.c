/*=============================================================
// �� �� ����rpdiv(a,n,b,m,q,r)
// �������������ϵ����ʾ��ʵϵ���Ķ���ʽA��B���
       �̶���ʽϵ������q���ʽϵ������r��
// ���������a������ʽAϵ������n��ϵ��������
       b������ʽBϵ������m��ϵ��������
       q���̶���ʽQϵ������k��ϵ��������k=max(n-m+1,0)
       r����ʽRϵ������l��ϵ����������Ҫl=n
// �� �� ֵ���������֡�����ɹ��򷵻�1�����򷵻�0
//==============================================================*/
#include"stdio.h"

int rpdiv(a, n, b, m, q, k, r, l)

double *a, *b, *q, *r;
int n, m, k, l;
{
int i, j, kk, jj;
if((a==NULL)||(b==NULL)||(q==NULL)||(r==NULL)) /* ���ָ���Ƿ�Ϊ��*/
{
printf("(rpdiv)NULL pointer found.\n");
return(0);
}
if(l!=n)                    /* �����ʽ�Ŀռ��Ƿ��㹻*/
{
printf("(rpdiv)please set the length of r to n.\n");
return(0);
}
for(
i = 0;
i<n;
i++)                /* ��ʼ����ʽ����*/
r[i] = a[i];
for(
i = 0;
i<k;
i++)
q[i] = 0.0;

if(b[m-1]+1.0==1.0)                /* ����ʽ������ϵ�������伸��Ϊ0������������*/
{
printf("(rpdiv)Cannot divide zero");
return(0);
}
for(
i = 0;
i<k;
i++)
{
kk = k - i - 1;
jj = n - i - 1;
q[kk] = r[jj]/b[m-1];            /* ���㵱ǰ��*/
r[jj] = 0.0;                /* ����ʽ�м�ȥ��ǰ�������ʽB�ĳ˻�*/
for(
j = 0;
j<m-1; j++)
r[j+kk] -= q[kk]*b[j];
}
return(1);
}

