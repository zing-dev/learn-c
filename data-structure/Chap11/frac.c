/*=============================================================
// �� �� ����frac
// �����������������ʽ������ֵ��
// ���������fa �����i��ϵ��a��b�ĺ�����ָ��
//        nmax ���Ƽ����������
//           e1 ����Ҫ�󣬵����ε��Ƶ�ֵ�仯��С��e1ʱ����Ϊ������
//         e0 ��С����ֵ���ӽ��������ܱ�ʾ����С���ݡ�Ϊ������㣬���������õ�ֵ��
// �� �� ֵ������ʽ������ֵ
//==============================================================*/
#include "math.h"

double frac(fab, nmax, e1, e0)

double *fab(), e0, e1;

int nmax;
{
int j;
double f, a, b, ab[2];
double c, d, t;
fab(0,ab);
f = ab[1];                         /* ���ó�ֵ*/
if(
fabs(f)
< e0)
f = e0;
c = f;
d = 0.0;
j = 1;
do
{
fab(j, ab
);                      /* ������һ�ڵ�ϵ��a��b*/
a = ab[0];
b = ab[1];
d = b + a * d;                    /* ����cj��dj*/
c = b + a / c;
if(
fabs(d)
< e0)               /* ��С��e0������Ϊ��0*/
d = e0;
if(
fabs(c)
< e0)
c = e0;
d = 1.0 / d;                    /* ����djֵ*/
t = c * d;
f = f * t;                        /* �����µ�����ʽֵ*/
j++;
}while((
fabs(t
-1.0)>e1)&&(j<nmax)); /* ѭ����ֹ����*/
return(f);
}
