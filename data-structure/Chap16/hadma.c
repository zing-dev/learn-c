/*=============================================================
// �� �� ����hadma1 (x,n,y)
// ����������������任
// ���������x���任��ʼֵ����n��ϵ����������y���任�����У�
// �� �� ֵ���������֡�����ɹ��򷵻�1�����򷵻�0
//==============================================================*/
#include "stdio.h"
#include "stdlib.h"
#include "math.h"

int hadma(y, n, x)

int n;
double *x, *y;
{
int i, j, k, nn;
double t;

int hadma1(double *x, int n, double *y);    /* ��ΪҪ�ݹ���ã�����������*/
k = log(n - 0.5) / log(2.0) + 1;                  /* ���k��ʹ2^k>=n>2^(k-1) */
nn = 1;                                /* �ж�n�Ƿ���2�������ݣ����ǵĻ��˳�����*/
for(
i = 0;
i<k;
i++)
nn = nn << 1;
if(nn != n)
{
printf("n should be 2^k.\n");
return(0);
}
j = hadma1(y, n, x);                               /* �����Ӻ��������ͷ����еĲ���*/
if(j)
{
t = 1.0 / sqrt(n);
for(
i = 0;
i<n;
i++)                               /* ���Ӻ������صĽ������n^0.5*/
x[i] *=
t;
}
return(j);
}
int hadma1(x, n, y)
int n;
double *x, *y;
{
int i, j, k;
double t;
if(n==1)
{                                     /* �����г���Ϊ1ʱ���ֶ�ʲ�任��������*/
y[0] = x[0];
return(1);
}
k = n >> 1;                             /* k��n��һ�룬������С��ģ������Ҫ����ռ��С*/
i = hadma1(x, k, y);                 /* �ݹ���ô˺������任ǰһ��*/
j = hadma1(x + k, k, y + k);                 /* �ݹ���ô˺������任��һ��*/
if(
i &&j
)                                /* ���õ��������������ۺ�����*/
{
for(
i = 0;
i<k;
i++)
{                                         /* һ��һ������������е��ۺ�*/
t = y[i + k];
y[i+k] = y[i] -
t;
y[i] = y[i] +
t;
}
}
return(1);
}
