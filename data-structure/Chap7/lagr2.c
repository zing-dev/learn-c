#include "stdio.h"
#include "math.h"

/*======================================================
// ��������lagr2
// �����������������������߲�ֵ
// ���������x ָ����n���������ݵ������ָ��
//           y ָ����n�����ĺ���ֵ�������ָ��
//           n ������
//           t ָ���Ĳ�ֵ��
// ����ֵ��  ��ָ����ֵ��ĺ�������ֵ
=========================================================*/
double lagr2(x, y, n, t)

double *x, *y, t;
int n;
{
int i, j, k;
double z, tmp;
if((x==NULL)||(y==NULL))             /* �������ָ���Ƿ�Ϊ��*/
{
printf("Pointer is Null\n");
return(0.0);
}
if(n<1)                              /* û���ṩ��㣬����0.0*/
return(0.0);
if(n==1)                             /* ֻ��һ����㣬���ش˺���ֵ*/
return(y[0]);
if(n==2)
{
z = (y[0] * (t - x[1]) - y[1] * (t - x[0])) / (x[0] - x[1]);
return(z);
}
k = 0;
while((x[k]<t)&&(k<n))               /* Ѱ�Һ��ʵ�����*/
k++;
k = k - 1;
if(k < 1)
k = 0;
if(k > (n-3))
k = n - 3;
z = 0.0;
printf("lagr2: %d,%d\n",k,k+2);      /* ��ӡʹ�õ�����*/
for(
i = k;
i<k+3; i++)                 /* �����ֵ�Ľ��*/
{
tmp = 1.0;
for(
j = k;
j<k+3; j++)
if(j!=i)
tmp = tmp * (t - x[j]) / (x[i] - x[j]);
z = z + tmp * y[i];
}
return(z);
}
