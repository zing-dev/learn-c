#include "math.h"

/*======================================================
// ��������cheb
// �����������б�ѩ����������л���
// ���������a �������ޣ�b ��������,
//           n0 ��ʼ������
//           eps ����Ҫ��
//           h0 ��С����
//           f ָ�򱻻�������ָ��
// ����ֵ��  ���ֽ���ֵ
=========================================================*/
double cheb(a, b, n0, eps, h0, f)

double a, b, eps, h0;
int n0;

double (*f)();

{
int n, i, j;
double z, z2, h, d, x;
static double t[5] = {-0.951056516295154, -0.587785252292473, 0.0,
                      0.587785252292473, 0.951056516295154}; /* 5���б�ѩ�����ʽ�����*/
n = n0;                            /* ��ʼ�Ļ�����*/
h = (b - a) / n;                       /* ��ó�ʼ����*/
z = 0.0;                            /* �����ʼ�Ļ���ֵ*/
for(
i = 0;
i<n;
i++)
{
x = a + i * h + h / 2.0;
for(
j = 0;
j<5; j++)
z = z + (*f)(h / 2.0 * t[j] + x);
}
z = z * h / 5.0;                        /* �������ٳ˷�����*/
do
{
n = 2 * n;                           /* ���»�����*/
h = h / 2.0;                          /* ���²���*/
z2 = 0.0;                         /* �����µĻ���ֵ*/
for(
i = 0;
i<n;
i++)
{
x = a + i * h + h / 2.0;
for(
j = 0;
j<5; j++)
z2 = z2 + (*f)(h / 2.0 * t[j] + x);
}
z2 = z2 * h / 5.0;                   /* �������ٳ˷�����*/
d = fabs(z2 - z);                  /* �������λ���ֵ�Ĳ�*/
z = z2;                          /* ���»���ֵ*/
}while((d>eps)&&(h>h0));
return(z);
}
