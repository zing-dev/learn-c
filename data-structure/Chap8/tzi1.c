#include "math.h"

/*======================================================
// ��������tzi1
// �����������䲽�����������
// ���������a �������ޣ�b ��������,
//           n0 ��ʼ������
//           eps ����Ҫ��
//           h0 ��С����
//           f ָ�򱻻�������ָ��
// ����ֵ��  ���ֽ���ֵ
=========================================================*/
double tzi1(a, b, n0, eps, h0, f)

double a, b, eps, h0;
int n0;

double (*f)();

{
int n, k;
double z, z2, h, d, x, t;
n = n0;                            /* ��ʼ�Ļ�����*/
h = (b - a) / n;                       /* ��ó�ʼ����*/
z = ((*f)(a) + (*f)(b)) / 2.0;         /* �����ʼ�Ļ���ֵ*/
for(
k = 1;
k<n;
k++)
{
x = a + k * h;
z = z + (*f)(x) * h;                   /* �۴����*/
}
z = z * h;                           /* �������ٳ˷�����*/
do
{
t = 0.0;
for(
k = 0;
k<n;
k++)
{
x = a + (k + 0.5) * h;
t = t + (*f)(x);
}
z2 = (z + h * t) / 2.0;                /* �����µĻ���ֵ*/
d = fabs(z2 - z);                  /* �������λ���ֵ�Ĳ�*/
z = z2;                          /* ���»���ֵ*/
h = h / 2.0;                       /* ���²���*/
n = 2 * n;                         /* ���»�����*/
}while((d>eps)&&(h>h0));
return(z);
}
