/*=============================================================
// �� �� ����mgst
// ������������·�鲢����
// ��������� x ��Ŵ��������ݵ�����
//            n ���鳤��
// �� �� ֵ����
//==============================================================*/
#include "stdlib.h"

void mgst(x, n)

int *x;
int n;
{
int i, flag, L, *x1;

void Merge();                              /* ��Ҫ���õĹ鲢����*/
x1 = (int *) malloc(n * sizeof(int));
L = 1;
flag = 1;
while(L<n)
{
if(flag)
Merge(x, x1, n, L
);                    /* �鲢���򣬽������x1��*/
else
Merge(x1, x, n, L
);                    /* �鲢���򣬽������x��*/
flag = 1 - flag;
L = 2 * L;
}
if(flag==0)
for(
i = 0;
i<n;
i++)
x[i] = x1[i];
free(x1);
return;
}

void Merge(x, x1, n, L)                       /* ������x�е�ÿ������ΪL���������й鲢��x1��*/
int *x, *x1, n, L;
{
int i, j, k, s, m, t, t2;
s = 0;                                 /* ���鲢��һ�����еĵ�һ��Ԫ��λ��*/
t2 = n - 2 * L + 1;
while(s<t2)
{
m = s + L - 1;                         /* ��һ�����е�ĩβ*/
t = m + L;                           /* �ڶ������е�ĩβ*/
i = s;                             /* ��һ�����еĿ�ͷλ��*/
j = m + 1;                           /* �ڶ������еĿ�ͷλ��*/
k = s;                             /* x1�д�Ź鲢�����е���ʼλ��*/
while(i<=
m &&j
<=t)                /* �������ж�����Ԫ��ʱ�����β���*/
if(x[i]<x[j])
x1[k++] = x[i++];
else
x1[k++] = x[j++];
while(i<=m)
x1[k++] = x[i++];
while(j<=t)
x1[k++] = x[j++];
s = s + 2 * L;
}
if(s+L<n)                            /* ĩβ����������һ��һ��*/
{
m = s + L - 1;                         /* ��һ�����е�ĩβ*/
t = n - 1;                           /* �ڶ������е�ĩβ*/
i = s;                             /* ��һ�����еĿ�ͷλ��*/
j = m + 1;                           /* �ڶ������еĿ�ͷλ��*/
k = s;                             /* x1�д�Ź鲢�����е���ʼλ��*/
while(i<=
m &&j
<=t)                /* �������ж�����Ԫ��ʱ�����β���*/
if(x[i]<x[j])
x1[k++] = x[i++];
else
x1[k++] = x[j++];
while(i<=m)
x1[k++] = x[i++];
while(j<=t)
x1[k++] = x[j++];
s = s + 2 * L;
}
else
for(
i = s;
i<n;
i++)                  /* ĩβֻ��һ�����У�ֱ�ӿ���*/
x1[i] = x[i];
}